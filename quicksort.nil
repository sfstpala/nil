(define filter (lambda (xs fn)
    (if xs
            (+
                (if (fn (car xs))
                        (list (car xs))
                    (list))
                (filter (cdr xs) fn))
        xs)))

(define <= (lambda (x y)
    (if (> x y)
            0
        1)))

(define quicksort (lambda (xs)
    (if xs
            ((lambda (a b c) (+ (+ a b) c))
                (quicksort (filter (cdr xs) (lambda (x) (> (car xs) x))))
                (list (car xs))
                (quicksort (filter (cdr xs) (lambda (x) (<= (car xs) x)))))
        xs)))

(print (list 4 7 3 1 9 5 4 6))
(print (quicksort (list 4 7 3 1 9 5 4 6)))
